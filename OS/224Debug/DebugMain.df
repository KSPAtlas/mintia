#include "<df>/dragonfruit.h"
#include "<inc>/HALConsole.h"
#include "<inc>/HALLog.h"

#include "<inc>/DebugTrace.h"

extern DebugPrompt { -- }

externptr HALDebugDumpFunction
externptr HALDebuggerFunction

fn DebugInit { -- }
	pointerof DebugDump HALDebugDumpFunction!

	pointerof DebugMain HALDebuggerFunction!
end

fn DebugMain { -- }
	auto oldmode
	CONSOLEMODETTY HALConsoleSetMode oldmode!

	"224Debug invoked!\n" "DebugMain" HALLog

	DebugPrompt

	oldmode@ HALConsoleSetMode drop
end